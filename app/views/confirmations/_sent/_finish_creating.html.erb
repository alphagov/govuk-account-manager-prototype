<% content_for :title, t("confirmation_sent.heading.finish_creating") %>

<%= render "govuk_publishing_components/components/heading", {
  text: yield(:title),
  heading_level: 1,
  margin_bottom: 4,
  font_size: "xl",
} %>

<% if returning_service == :brexit %>
  <p class="govuk-body"><%= t("confirmation_sent.instructions.finish_creating.must_continue") %></p>

  <%= form_tag redirect_to_previous_url_path, method: :post, :"data-module" => "explicit-cross-domain-links" do %>
    <%= hidden_field_tag :previous_url, params[:previous_url] %>
    <%= render "govuk_publishing_components/components/button", {
      text: t("confirmation_sent.continue_to.brexit"),
      data_attributes: {
        module: "gem-track-click",
        "track-category": "account-create",
        "track-action": "confirm-email",
        "track-label": "Brexit checker",
      },
      margin_bottom: 3,
    } %>
  <% end %>
<% end %>

<%= sanitize(t("confirmation_sent.instructions.finish_creating.details.#{returning_service}", email: email)) %>

<%= render "govuk_publishing_components/components/inset_text", {
  text: t("confirmation_sent.delay_consequence")
} %>

<% if returning_service == :dashboard %>
  <p class="govuk-body" data-module="gem-track-click">
    <a class="govuk-link" href="<%= user_root_path %>" data-track-category="account-create" data-track-action="confirm-email" data-track-label="Account">
      <%= t("confirmation_sent.continue_to.account") %>
    </a>
  </p>
<% end %>

<% if returning_service == :brexit %>
  <%= render "govuk_publishing_components/components/details", {
    title: t("confirmation_sent.help.title"),
  } do %>
    <%= sanitize(t("confirmation_sent.help.instructions.finish_creating", resend_confirmation_link: new_user_confirmation_path, retry_link: edit_user_registration_email_path, email: email)) %>
  <% end %>
<% else %>
  <%= render "govuk_publishing_components/components/heading", {
    text: t("confirmation_sent.help.heading"),
    heading_level: 2,
    margin_bottom: 3,
    font_size: 19,
  } %>

  <%= sanitize(t("confirmation_sent.help.instructions.finish_creating", resend_confirmation_link: new_user_confirmation_path, retry_link: edit_user_registration_email_path, email: email)) %>
<% end %>
